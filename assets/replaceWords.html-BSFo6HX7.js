import{_ as s,c as a,a as p,o as t}from"./app-DFQd3Cw_.js";const e={};function o(l,n){return t(),a("div",null,n[0]||(n[0]=[p(`<h1 id="项目名称" tabindex="-1"><a class="header-anchor" href="#项目名称"><span>项目名称</span></a></h1><p>批量替换Word文档内容</p><h2 id="项目描述" tabindex="-1"><a class="header-anchor" href="#项目描述"><span>项目描述</span></a></h2><p>这是一个使用Python和Tkinter构建的GUI应用程序，用于批量替换指定文件夹中的Word文档内容。用户可以选择文件夹、输入要替换的旧文本和新文本，并指定输出文件夹。程序会遍历文件夹中的所有Word文档，替换指定内容，并将修改后的文档保存到输出文件夹。</p><h2 id="依赖项" tabindex="-1"><a class="header-anchor" href="#依赖项"><span>依赖项</span></a></h2><ul><li>Python 3.x</li><li><a href="command:_github.copilot.openSymbolFromReferences?%5B%22%22%2C%5B%7B%22uri%22%3A%7B%22scheme%22%3A%22file%22%2C%22authority%22%3A%22%22%2C%22path%22%3A%22%2Ff%3A%2FA-MyUI%2Fcnmd-icu%2Fsrc%2Fposts%2FPython%2F%E6%89%B9%E9%87%8F%E6%9B%BF%E6%8D%A2%E6%96%87%E6%A1%A3%E5%86%85%E5%AE%B9%2FREADME.md%22%2C%22query%22%3A%22%22%2C%22fragment%22%3A%22%22%7D%2C%22pos%22%3A%7B%22line%22%3A20%2C%22character%22%3A4%7D%7D%5D%2C%22d7e38168-7de5-4b5e-9caa-c65204d1e8b3%22%5D" title="Go to definition" target="_blank" rel="noopener noreferrer"><code>tkinter</code></a>：Python内置的GUI库</li><li><code>python-docx</code>：用于处理Word文档</li><li><a href="command:_github.copilot.openSymbolFromReferences?%5B%22%22%2C%5B%7B%22uri%22%3A%7B%22scheme%22%3A%22file%22%2C%22authority%22%3A%22%22%2C%22path%22%3A%22%2Ff%3A%2FA-MyUI%2Fcnmd-icu%2Fsrc%2Fposts%2FPython%2F%E6%89%B9%E9%87%8F%E6%9B%BF%E6%8D%A2%E6%96%87%E6%A1%A3%E5%86%85%E5%AE%B9%2FREADME.md%22%2C%22query%22%3A%22%22%2C%22fragment%22%3A%22%22%7D%2C%22pos%22%3A%7B%22line%22%3A22%2C%22character%22%3A4%7D%7D%5D%2C%22d7e38168-7de5-4b5e-9caa-c65204d1e8b3%22%5D" title="Go to definition" target="_blank" rel="noopener noreferrer"><code>pyinstaller</code></a>：用于将Python脚本打包成可执行文件</li></ul><h2 id="安装依赖项" tabindex="-1"><a class="header-anchor" href="#安装依赖项"><span>安装依赖项</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">pip <span class="token function">install</span> python-docx</span>
<span class="line">pip <span class="token function">install</span> pyinstaller</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="使用方法" tabindex="-1"><a class="header-anchor" href="#使用方法"><span>使用方法</span></a></h2><ol><li>运行脚本：<div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">python 批量替换word文档内的内容.py</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li>选择要处理的文件夹。</li><li>输入要替换的旧文本和新文本。</li><li>选择输出文件夹。</li><li>点击“开始替换”按钮，程序将开始处理文件，并显示进度和统计信息。</li></ol><h2 id="代码" tabindex="-1"><a class="header-anchor" href="#代码"><span>代码</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">import</span> os</span>
<span class="line"><span class="token keyword">import</span> tkinter <span class="token keyword">as</span> tk</span>
<span class="line"><span class="token keyword">from</span> tkinter <span class="token keyword">import</span> filedialog<span class="token punctuation">,</span> messagebox</span>
<span class="line"><span class="token keyword">from</span> tkinter <span class="token keyword">import</span> ttk</span>
<span class="line"><span class="token keyword">import</span> logging</span>
<span class="line"><span class="token keyword">from</span> docx <span class="token keyword">import</span> Document</span>
<span class="line"></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">replace_text_in_docx</span><span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> old_text<span class="token punctuation">,</span> new_text<span class="token punctuation">,</span> output_folder<span class="token punctuation">,</span> success_files<span class="token punctuation">,</span> failed_files<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">try</span><span class="token punctuation">:</span></span>
<span class="line">        doc <span class="token operator">=</span> Document<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">for</span> para <span class="token keyword">in</span> doc<span class="token punctuation">.</span>paragraphs<span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">if</span> old_text <span class="token keyword">in</span> para<span class="token punctuation">.</span>text<span class="token punctuation">:</span></span>
<span class="line">                para<span class="token punctuation">.</span>text <span class="token operator">=</span> para<span class="token punctuation">.</span>text<span class="token punctuation">.</span>replace<span class="token punctuation">(</span>old_text<span class="token punctuation">,</span> new_text<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">for</span> table <span class="token keyword">in</span> doc<span class="token punctuation">.</span>tables<span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">for</span> row <span class="token keyword">in</span> table<span class="token punctuation">.</span>rows<span class="token punctuation">:</span></span>
<span class="line">                <span class="token keyword">for</span> cell <span class="token keyword">in</span> row<span class="token punctuation">.</span>cells<span class="token punctuation">:</span></span>
<span class="line">                    <span class="token keyword">if</span> old_text <span class="token keyword">in</span> cell<span class="token punctuation">.</span>text<span class="token punctuation">:</span></span>
<span class="line">                        cell<span class="token punctuation">.</span>text <span class="token operator">=</span> cell<span class="token punctuation">.</span>text<span class="token punctuation">.</span>replace<span class="token punctuation">(</span>old_text<span class="token punctuation">,</span> new_text<span class="token punctuation">)</span></span>
<span class="line">        </span>
<span class="line">        new_file_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>output_folder<span class="token punctuation">,</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>basename<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        doc<span class="token punctuation">.</span>save<span class="token punctuation">(</span>new_file_path<span class="token punctuation">)</span></span>
<span class="line">        logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;文件已保存: </span><span class="token interpolation"><span class="token punctuation">{</span>new_file_path<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">        success_files<span class="token punctuation">.</span>append<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span></span>
<span class="line">        logging<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;处理文件 </span><span class="token interpolation"><span class="token punctuation">{</span>file_path<span class="token punctuation">}</span></span><span class="token string"> 时出错: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">        failed_files<span class="token punctuation">.</span>append<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">batch_replace_in_docx_files</span><span class="token punctuation">(</span>folder_path<span class="token punctuation">,</span> old_text<span class="token punctuation">,</span> new_text<span class="token punctuation">,</span> output_folder<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    success_files <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line">    failed_files <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">try</span><span class="token punctuation">:</span></span>
<span class="line">        os<span class="token punctuation">.</span>makedirs<span class="token punctuation">(</span>output_folder<span class="token punctuation">,</span> exist_ok<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line">        docx_files <span class="token operator">=</span> <span class="token punctuation">[</span>f <span class="token keyword">for</span> f <span class="token keyword">in</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>folder_path<span class="token punctuation">)</span> <span class="token keyword">if</span> f<span class="token punctuation">.</span>endswith<span class="token punctuation">(</span><span class="token string">&#39;.docx&#39;</span><span class="token punctuation">)</span><span class="token punctuation">]</span></span>
<span class="line">        total_files <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>docx_files<span class="token punctuation">)</span></span>
<span class="line">        </span>
<span class="line">        <span class="token keyword">for</span> i<span class="token punctuation">,</span> filename <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>docx_files<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">            file_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>folder_path<span class="token punctuation">,</span> filename<span class="token punctuation">)</span></span>
<span class="line">            replace_text_in_docx<span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> old_text<span class="token punctuation">,</span> new_text<span class="token punctuation">,</span> output_folder<span class="token punctuation">,</span> success_files<span class="token punctuation">,</span> failed_files<span class="token punctuation">)</span></span>
<span class="line">            progress_var<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> total_files <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span></span>
<span class="line">            stats_label<span class="token punctuation">.</span>config<span class="token punctuation">(</span>text<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f&quot;总文件数: </span><span class="token interpolation"><span class="token punctuation">{</span>total_files<span class="token punctuation">}</span></span><span class="token string"> 成功替换: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">len</span><span class="token punctuation">(</span>success_files<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> 替换失败: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">len</span><span class="token punctuation">(</span>failed_files<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">            root<span class="token punctuation">.</span>update_idletasks<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span></span>
<span class="line">        logging<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;批量处理文件时出错: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;文件总数: </span><span class="token interpolation"><span class="token punctuation">{</span>total_files<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">    logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;成功: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">len</span><span class="token punctuation">(</span>success_files<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">    logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;失败: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">len</span><span class="token punctuation">(</span>failed_files<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">if</span> failed_files<span class="token punctuation">:</span></span>
<span class="line">        logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;修改失败的文件: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token string">&#39;, &#39;</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>failed_files<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">return</span> total_files<span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>success_files<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>failed_files<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">select_folder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    folder_path <span class="token operator">=</span> filedialog<span class="token punctuation">.</span>askdirectory<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">if</span> folder_path<span class="token punctuation">:</span></span>
<span class="line">        folder_entry<span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> tk<span class="token punctuation">.</span>END<span class="token punctuation">)</span></span>
<span class="line">        folder_entry<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> folder_path<span class="token punctuation">)</span></span>
<span class="line">        total_files <span class="token operator">=</span> count_docx_files<span class="token punctuation">(</span>folder_path<span class="token punctuation">)</span></span>
<span class="line">        stats_label<span class="token punctuation">.</span>config<span class="token punctuation">(</span>text<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f&quot;总文件数: </span><span class="token interpolation"><span class="token punctuation">{</span>total_files<span class="token punctuation">}</span></span><span class="token string"> 成功替换: 0 替换失败: 0&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">select_output_folder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    output_folder <span class="token operator">=</span> filedialog<span class="token punctuation">.</span>askdirectory<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">if</span> output_folder<span class="token punctuation">:</span></span>
<span class="line">        output_folder_entry<span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> tk<span class="token punctuation">.</span>END<span class="token punctuation">)</span></span>
<span class="line">        output_folder_entry<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> output_folder<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">count_docx_files</span><span class="token punctuation">(</span>folder_path<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token keyword">for</span> filename <span class="token keyword">in</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>folder_path<span class="token punctuation">)</span> <span class="token keyword">if</span> filename<span class="token punctuation">.</span>endswith<span class="token punctuation">(</span><span class="token string">&#39;.docx&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">start_replacement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    folder_path <span class="token operator">=</span> folder_entry<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    old_text <span class="token operator">=</span> old_text_entry<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    new_text <span class="token operator">=</span> new_text_entry<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    output_folder <span class="token operator">=</span> output_folder_entry<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">if</span> <span class="token keyword">not</span> folder_path <span class="token keyword">or</span> <span class="token keyword">not</span> old_text <span class="token keyword">or</span> <span class="token keyword">not</span> new_text <span class="token keyword">or</span> <span class="token keyword">not</span> output_folder<span class="token punctuation">:</span></span>
<span class="line">        messagebox<span class="token punctuation">.</span>showwarning<span class="token punctuation">(</span><span class="token string">&quot;警告&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;请填写所有字段&quot;</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">return</span></span>
<span class="line"></span>
<span class="line">    total_files<span class="token punctuation">,</span> success_count<span class="token punctuation">,</span> failed_count <span class="token operator">=</span> batch_replace_in_docx_files<span class="token punctuation">(</span>folder_path<span class="token punctuation">,</span> old_text<span class="token punctuation">,</span> new_text<span class="token punctuation">,</span> output_folder<span class="token punctuation">)</span></span>
<span class="line">    messagebox<span class="token punctuation">.</span>showinfo<span class="token punctuation">(</span><span class="token string">&quot;完成&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;批量替换操作完成&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    stats_label<span class="token punctuation">.</span>config<span class="token punctuation">(</span>text<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f&quot;总文件数: </span><span class="token interpolation"><span class="token punctuation">{</span>total_files<span class="token punctuation">}</span></span><span class="token string"> 成功替换: </span><span class="token interpolation"><span class="token punctuation">{</span>success_count<span class="token punctuation">}</span></span><span class="token string"> 替换失败: </span><span class="token interpolation"><span class="token punctuation">{</span>failed_count<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">    progress_var<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 创建主窗口</span></span>
<span class="line">root <span class="token operator">=</span> tk<span class="token punctuation">.</span>Tk<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">root<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&quot;批量替换Word文档内容&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 文件夹选择</span></span>
<span class="line">tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>root<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">&quot;选择文件夹:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> padx<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> pady<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span></span>
<span class="line">folder_entry <span class="token operator">=</span> tk<span class="token punctuation">.</span>Entry<span class="token punctuation">(</span>root<span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">)</span></span>
<span class="line">folder_entry<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> padx<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> pady<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span></span>
<span class="line">tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>root<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">&quot;浏览&quot;</span><span class="token punctuation">,</span> command<span class="token operator">=</span>select_folder<span class="token punctuation">)</span><span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> padx<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> pady<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 旧文本输入</span></span>
<span class="line">tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>root<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">&quot;替换内容:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> padx<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> pady<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span></span>
<span class="line">old_text_entry <span class="token operator">=</span> tk<span class="token punctuation">.</span>Entry<span class="token punctuation">(</span>root<span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">)</span></span>
<span class="line">old_text_entry<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> padx<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> pady<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 新文本输入</span></span>
<span class="line">tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>root<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">&quot;新的内容:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> padx<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> pady<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span></span>
<span class="line">new_text_entry <span class="token operator">=</span> tk<span class="token punctuation">.</span>Entry<span class="token punctuation">(</span>root<span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">)</span></span>
<span class="line">new_text_entry<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> padx<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> pady<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 输出文件夹输入</span></span>
<span class="line">tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>root<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">&quot;输出文件夹:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> padx<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> pady<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span></span>
<span class="line">output_folder_entry <span class="token operator">=</span> tk<span class="token punctuation">.</span>Entry<span class="token punctuation">(</span>root<span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">)</span></span>
<span class="line">output_folder_entry<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> padx<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> pady<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span></span>
<span class="line">tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>root<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">&quot;浏览&quot;</span><span class="token punctuation">,</span> command<span class="token operator">=</span>select_output_folder<span class="token punctuation">)</span><span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> padx<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> pady<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 开始按钮</span></span>
<span class="line">tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>root<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">&quot;开始替换&quot;</span><span class="token punctuation">,</span> command<span class="token operator">=</span>start_replacement<span class="token punctuation">)</span><span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> padx<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> pady<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 统计信息标签</span></span>
<span class="line">stats_label <span class="token operator">=</span> tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>root<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">&quot;总文件数: 0 成功替换: 0 替换失败: 0&quot;</span><span class="token punctuation">)</span></span>
<span class="line">stats_label<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> padx<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> pady<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 进度条</span></span>
<span class="line">progress_var <span class="token operator">=</span> tk<span class="token punctuation">.</span>DoubleVar<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">progress_bar <span class="token operator">=</span> ttk<span class="token punctuation">.</span>Progressbar<span class="token punctuation">(</span>root<span class="token punctuation">,</span> variable<span class="token operator">=</span>progress_var<span class="token punctuation">,</span> maximum<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span></span>
<span class="line">progress_bar<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> columnspan<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> padx<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> pady<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> sticky<span class="token operator">=</span><span class="token string">&quot;ew&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 运行主循环</span></span>
<span class="line">root<span class="token punctuation">.</span>mainloop<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,12)]))}const i=s(e,[["render",o],["__file","replaceWords.html.vue"]]),u=JSON.parse('{"path":"/posts/Python/replaceWords.html","title":"批量替换Word文档内容","lang":"zh-CN","frontmatter":{"title":"批量替换Word文档内容","icon":"tool","subtitle":"python","date":"2023-03-24T10:52:27.000Z","isOriginal":true,"category":["python"],"tag":["工具脚本"],"description":"项目名称 批量替换Word文档内容 项目描述 这是一个使用Python和Tkinter构建的GUI应用程序，用于批量替换指定文件夹中的Word文档内容。用户可以选择文件夹、输入要替换的旧文本和新文本，并指定输出文件夹。程序会遍历文件夹中的所有Word文档，替换指定内容，并将修改后的文档保存到输出文件夹。 依赖项 Python 3.x tkinter：P...","head":[["meta",{"property":"og:url","content":"https://www.cnmd.icu/posts/Python/replaceWords.html"}],["meta",{"property":"og:site_name","content":"氚花盏-三个三"}],["meta",{"property":"og:title","content":"批量替换Word文档内容"}],["meta",{"property":"og:description","content":"项目名称 批量替换Word文档内容 项目描述 这是一个使用Python和Tkinter构建的GUI应用程序，用于批量替换指定文件夹中的Word文档内容。用户可以选择文件夹、输入要替换的旧文本和新文本，并指定输出文件夹。程序会遍历文件夹中的所有Word文档，替换指定内容，并将修改后的文档保存到输出文件夹。 依赖项 Python 3.x tkinter：P..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-10-16T09:04:18.000Z"}],["meta",{"property":"article:tag","content":"工具脚本"}],["meta",{"property":"article:published_time","content":"2023-03-24T10:52:27.000Z"}],["meta",{"property":"article:modified_time","content":"2024-10-16T09:04:18.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"批量替换Word文档内容\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2023-03-24T10:52:27.000Z\\",\\"dateModified\\":\\"2024-10-16T09:04:18.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"三个三\\",\\"url\\":\\"https://www.cnmd.icu\\",\\"email\\":\\"mailto:2029364173@qq.com\\"}]}"]]},"headers":[{"level":2,"title":"项目描述","slug":"项目描述","link":"#项目描述","children":[]},{"level":2,"title":"依赖项","slug":"依赖项","link":"#依赖项","children":[]},{"level":2,"title":"安装依赖项","slug":"安装依赖项","link":"#安装依赖项","children":[]},{"level":2,"title":"使用方法","slug":"使用方法","link":"#使用方法","children":[]},{"level":2,"title":"代码","slug":"代码","link":"#代码","children":[]}],"git":{"createdTime":1729069458000,"updatedTime":1729069458000,"contributors":[{"name":"cnmd-icu","email":"2029364173@qq.com","commits":1}]},"readingTime":{"minutes":3.75,"words":1124},"filePathRelative":"posts/Python/replaceWords.md","localizedDate":"2023年3月24日","excerpt":"\\n<p>批量替换Word文档内容</p>\\n<h2>项目描述</h2>\\n<p>这是一个使用Python和Tkinter构建的GUI应用程序，用于批量替换指定文件夹中的Word文档内容。用户可以选择文件夹、输入要替换的旧文本和新文本，并指定输出文件夹。程序会遍历文件夹中的所有Word文档，替换指定内容，并将修改后的文档保存到输出文件夹。</p>\\n<h2>依赖项</h2>\\n<ul>\\n<li>Python 3.x</li>\\n<li><a href=\\"command:_github.copilot.openSymbolFromReferences?%5B%22%22%2C%5B%7B%22uri%22%3A%7B%22scheme%22%3A%22file%22%2C%22authority%22%3A%22%22%2C%22path%22%3A%22%2Ff%3A%2FA-MyUI%2Fcnmd-icu%2Fsrc%2Fposts%2FPython%2F%E6%89%B9%E9%87%8F%E6%9B%BF%E6%8D%A2%E6%96%87%E6%A1%A3%E5%86%85%E5%AE%B9%2FREADME.md%22%2C%22query%22%3A%22%22%2C%22fragment%22%3A%22%22%7D%2C%22pos%22%3A%7B%22line%22%3A20%2C%22character%22%3A4%7D%7D%5D%2C%22d7e38168-7de5-4b5e-9caa-c65204d1e8b3%22%5D\\" title=\\"Go to definition\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\"><code>tkinter</code></a>：Python内置的GUI库</li>\\n<li><code>python-docx</code>：用于处理Word文档</li>\\n<li><a href=\\"command:_github.copilot.openSymbolFromReferences?%5B%22%22%2C%5B%7B%22uri%22%3A%7B%22scheme%22%3A%22file%22%2C%22authority%22%3A%22%22%2C%22path%22%3A%22%2Ff%3A%2FA-MyUI%2Fcnmd-icu%2Fsrc%2Fposts%2FPython%2F%E6%89%B9%E9%87%8F%E6%9B%BF%E6%8D%A2%E6%96%87%E6%A1%A3%E5%86%85%E5%AE%B9%2FREADME.md%22%2C%22query%22%3A%22%22%2C%22fragment%22%3A%22%22%7D%2C%22pos%22%3A%7B%22line%22%3A22%2C%22character%22%3A4%7D%7D%5D%2C%22d7e38168-7de5-4b5e-9caa-c65204d1e8b3%22%5D\\" title=\\"Go to definition\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\"><code>pyinstaller</code></a>：用于将Python脚本打包成可执行文件</li>\\n</ul>","autoDesc":true}');export{i as comp,u as data};
